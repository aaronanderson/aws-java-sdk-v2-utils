# jax-rs-aws-signerv4
After scouring the Internet for a simple [AWS Signature Version 4 Signing](https://docs.aws.amazon.com/general/latest/gr/signature-version-4.html) java library with limited dependencies and support for JAX-RS 2.0 and not finding one I decided to write one. 

The main motivation for this library is to support JAX-RS calls to an AWS elasticsearch instance. the AWS Java API 2.0 has a client class for managing search domains but nothing for actually accessing the service.

Previously I had used the AWS SDK 2.0 preview to create a [S3 presigning URL](https://gist.github.com/aaronanderson/f9e2806cc5e2c18fab4d7e60c589d160) Java utility but the current SDK codebase is geared for autogenerated clients and it is nearly impossible to write a client by and that initializes all the prerequists. After examining several other Java AWS signinging implementations and studying the AWS signing documentation I was able to develop a solution that meets my requirements. As an added bonus I was able to add presigning capabilities for S3 with little effort.

## Configuration
Create an instance of the AWSSignerClientRequestFilter class using the builder. Provide the AWS 
```
DefaultCredentialsProvider provider  = DefaultCredentialsProvider.create();
credentials = provider.getCredentials();
AWSSignerClientRequestFilter.Builder builder = AWSSignerClientRequestFilter.builder().accessKeyID(credentials.accessKeyId()).secretAccessKey(credentials.secretAccessKey()).regionName("us-west-1").serviceName("es");
if (AwsSessionCredentials.class.isAssignableFrom(credentials.getClass())) {
  builder.sessionToken(() -> (((AwsSessionCredentials) credentials).sessionToken()));
}
AWSSignerClientRequestFilter signer = builder.build();
```
Note I have not actually testes the token session feature but it should work.
##JAX-RS
Just register the filter/interceptor
```
client.register(signer);
```
##Pre-Sign
Pass in the method, requestURI, and expiration duration
```
URI presigned = signer.presign("GET", new URI("https://some-s3-bucket.s3-us-west-1.amazonaws.com/intworkspace.json"), Duration.ofDays(1));
```